<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Specifying BAM error structure • bamr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Specifying BAM error structure">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bamr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/bamr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bam-likelihood.html">Manning likelihood</a>
    </li>
    <li>
      <a href="../articles/error_structure.html">Specifying BAM error structure</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/markwh/bamr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Specifying BAM error structure</h1>
                        <h4 class="author">Mark Hagemann</h4>
            
            <h4 class="date">2018-10-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/markwh/bamr/blob/master/vignettes/error_structure.Rmd"><code>vignettes/error_structure.Rmd</code></a></small>
      <div class="hidden name"><code>error_structure.Rmd</code></div>

    </div>

    
    
<p>Two primary sources of error provide the likelihood functions used by <strong>bamr</strong>. <em>Model error</em>, assumed to be log-normal, represents inability for even an optimally parameterized model to perfectly capture functional relationships between hydrologic variables in the wild. <em>Measurement error</em>, assumed to be normal, represents the discrepencey between measured quantities (e.g. the width of a river as measured by the SWOT satellite) and the true quantity (the actual width of the river). Model assumptions and common sense further dictate that the actual width, slope, and cross-sectional area cannot be negative, resulting in a <a href="https://en.wikipedia.org/wiki/Truncated_normal_distribution">truncated normal</a>, bounded below at the negative observation, for each measurement error.</p>
<p><strong>bamr</strong> implements this full error structure using latent variables that represent the actual (and unobserved) slope, width, and partial area. While this results in a fully specified model, it does so at the cost of additional parameters and additional resultant computational time. Each iteration of the Monte Carlo sampler needs to draw an additional <span class="math inline">\(N_x \times N_t \times 3\)</span> sample draws representing all <span class="math inline">\(S_{it}, W_{it}, \text{ and } dA_{it}, i = 1, \dots, N_x; t = 1, \dots, N_t\)</span> latent parameters.</p>
<p>In order to circumvent this additional computational time, <strong>bamr</strong> by default reparameterizes the measurement error, forcing it into the lognormal model-error structure. It does this by a simple method-of-moments estimation of <span class="math inline">\(\sigma^2_{logS}\)</span> and <span class="math inline">\(\sigma^2_{logW}\)</span> in the following equation:</p>
<p><span class="math display">\[
\log W_{it} = \log W_{obs, it} + \epsilon_{logW}\\
E[\epsilon_{logW}] = 0; Var[\epsilon_{logW}] = \sigma^2_{logW}
\]</span></p>
<p>This is only an approximation, as in reality only one of <span class="math inline">\(W - W_{obs}\)</span> or <span class="math inline">\(\log W - \log W_{obs}\)</span> can have mean of zero. However, it should be a sufficiently close approximation as to yield very similar results to the fully parameterized model.</p>
<div id="specifying-errors-in-bamr" class="section level3">
<h3 class="hasAnchor">
<a href="#specifying-errors-in-bamr" class="anchor"></a>Specifying errors in bamr</h3>
<p><strong>bamr</strong> has a couple of options–and associated defaults–for specifying error structure.</p>
<ul>
<li>In <code>bam_priors</code> the following are optional arguments:
<ul>
<li>
<code>sigma_man</code>, flow error standard deviation (in log space) arising from Manning’s equation</li>
<li>
<code>sigma_amhg</code>, flow error standard deviation (in log space) arising from AMHG</li>
<li>
<code>Werr_sd</code>, measurement error standard deviation (meters) for remote-sensed width</li>
<li>
<code>Serr_sd</code>, measurement error standard deviation (unitless) for remote-sensed slope</li>
<li>
<code>dAerr_sd</code>, measurement error standard deviation (square meters) for remote-sensed <span class="math inline">\(\delta A\)</span>
</li>
</ul>
</li>
<li>In <code>bam_estimate</code> the following are optional arguments:
<ul>
<li>
<code>meas_error</code> (default: <code>TRUE</code>) Include measurement error in likelihood calculation?</li>
<li>
<code>reparam</code> (default: <code>TRUE</code>) Reparameterize errors to make sampling faster? Setting this to <code>FALSE</code> will yield a more precise model structure, but may take on the order of 10x longer to compute.</li>
</ul>
</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Mark Hagemann.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
